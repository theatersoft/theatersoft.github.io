<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Theatersoft - Docs</title>
    <meta name="author" content="Theatersoft">
    <meta name="description" content="Theatersoft">
    <meta name="viewport" content="width=device-width"/>
    <link rel="manifest" href="assets/manifest.json">
    <link rel="icon" type="image/png" href="/assets/theatersoft-logo-round-accent-48.png"/>
    <link rel="stylesheet" href="/theatersoft.css">
    <script defer src="/theatersoft.js"></script>
    <script>
        window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
        ga('create', 'UA-105697373-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Organization",
        "url": "http://www.theatersoft.com",
        "name": "Theatersoft",
        "logo": "http://www.theatersoft.com/assets/theatersoft-logo-round-accent.png"
    }
    </script>
</head>
<body>
<svg display="none"><symbol id="svg-logo" viewBox="0 0 280 240"><path d="m132.7 21.94-100.5 58.06c-4.385 2.536-7.077 7.161-7.076 12.16v3.018 109.8c-.0029 7.791 6.424 14.11 14.36 14.11h64.73c7.932-.008 14.36-6.322 14.36-14.11v-25.11c10.5-5.275 17.85-15.91 17.85-28.16 0-17.37-14.63-31.75-32.31-31.75-17.68.00001-32.31 14.38-32.31 31.75 0 12.33 7.44 23.02 18.04 28.26v10.91h-35.99v-90.67l86.17-49.78 86.16 49.78v91.36l-35.8-.5008v-11.2c10.5-5.275 17.85-15.91 17.85-28.16 0-17.37-14.63-31.75-32.31-31.75s-32.31 14.38-32.31 31.75c0 12.33 7.44 23.02 18.04 28.26v25.01c-.005 7.718 6.307 14.01 14.16 14.11l64.51.8766c8.012.1153 14.57-6.231 14.57-14.1v-113.7c.00083-4.998-2.691-9.624-7.076-12.16l-100.6-58.1c-2.077-1.195-4.427-1.858-6.834-1.929-2.709-.0862-5.388.5824-7.726 1.929z"></path></symbol><symbol id="svg-github" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></symbol><symbol id="svg-list" viewBox="0 0 32 32"><path d="M25.6 14.4h-19.2c-0.883 0-1.6 0.717-1.6 1.6s0.717 1.6 1.6 1.6h19.2c0.885 0 1.6-0.717 1.6-1.6s-0.715-1.6-1.6-1.6zM6.4 11.2h19.2c0.885 0 1.6-0.717 1.6-1.6s-0.715-1.6-1.6-1.6h-19.2c-0.883 0-1.6 0.717-1.6 1.6s0.717 1.6 1.6 1.6zM25.6 20.8h-19.2c-0.883 0-1.6 0.715-1.6 1.6s0.717 1.6 1.6 1.6h19.2c0.885 0 1.6-0.715 1.6-1.6s-0.715-1.6-1.6-1.6z"></path></symbol><symbol id="svg-x" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></symbol></svg>
<nav><a href="/"><svg><use href="#svg-logo"></use></svg><span>Theatersoft</span></a><ul id="_566"><a href="/install/" class>Install</a><a href="/solutions/" class>Solutions</a><a href="https://community.theatersoft.com/" onclick="trackLink(event)" class>Community</a><a target="_blank" href="https://github.com/theatersoft"><svg><use href="#svg-github"></use></svg></a></ul><div id="_c62"><svg><use href="#svg-list"></use></svg></div></nav>
<header><div class="_e76"></div><div class="_720"></div><div class="_e95"><h1></h1></div></header>
<main class="_485"><article><div class="markdown"><h2 id="theatersoft-home">Theatersoft Home</h2>
<p>Theatersoft Home is a home automation hub where smart devices of all types work together inside a touchscreen web app. Theatersoft builds on a distributed platform of extensible messaging services to encourage community driven device support. Developer friendly APIs enable automations directly in JavaScript for completely customized scenarios.</p>
<h3 id="installation">Installation</h3>
<p>You can use any Linux machine such as a Raspberry Pi 3, mini PC, or container.</p>
<p>Create a directory to store your Theatersoft configuration; then install, configure, and deploy <code>@theatersoft/home</code>:</p>
<pre><code>mkdir example &amp;&amp; cd example
npm install @theatersoft/home
npm explore @theatersoft/home npm run config
npm run deploy
</code></pre><p>The Theatersoft server is now running. </p>
<p>See <a href="https://www.theatersoft.com/install/">www.theatersoft.com/install</a> for more instructions to:</p>
<ul>
<li>create a server certificate</li>
<li>pair a web client</li>
<li>use a custom domain name</li>
<li>set up external network access   </li>
<li>install the Z-Wave service and connect devices</li>
</ul>
<h1 id="bus">bus</h1>
<p>This message bus is the foundation of the Theatersoft platform. It enables communication between host Node.js servers and client web browsers to create a distributed application using modern Javascript.</p>
<h1 id="device">device</h1>
<p>Bus service module for aggregated device store</p>
<h1 id="server">server</h1>
<p>Theatersoft Server</p>
<h1 id="client">client</h1>
<p>Theatersoft Client</p>
<h1 id="components">components</h1>
<p>Theatersoft Components</p>
<h1 id="automation">automation</h1>
<p>Bus service module for automation agents</p>
<h1 id="-theatersoft-zwave">@theatersoft/zwave</h1>
<p><code>zwave</code> is a <a href="https://www.theatersoft.com">Theatersoft</a> <a href="https://github.com/theatersoft/bus">bus</a> service module that
encapsulates the <a href="https://github.com/OpenZWave">OpenZWave</a> library to provide consistent <a href="https://github.com/theatersoft/device">device</a> APIs for Z-Wave device control and state management. It also exports <a href="https://github.com/theatersoft/client">client</a> components for Z-Wave service and device configuration.</p>
<h2 id="installation">Installation</h2>
<ol>
<li><p>Install <a href="https://www.theatersoft.com/install">Theatersoft Home</a>. </p>
</li>
<li><p>Connect a USB Z-Wave controller supported by OpenZWave.   </p>
</li>
<li><p>Add a ZWave service configuration object to your site <code>config.json</code> to the <code>services</code> array of a <code>hosts</code> object. E.g:</p>
<pre><code class="language-json"> {
     &quot;module&quot;: &quot;@theatersoft/zwave&quot;,
     &quot;export&quot;: &quot;ZWave&quot;,
     &quot;name&quot;: &quot;ZWave&quot;,
     &quot;config&quot;: {
         &quot;port&quot;: &quot;/dev/ttyACM0&quot;,
         &quot;options&quot;: {
             &quot;NetworkKey&quot;: &quot;0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15,0x16&quot;,
             &quot;Logging&quot;: true,
             &quot;ConsoleOutput&quot;: true,
             &quot;SaveLogLevel&quot;: 5
         }
     }
 }
</code></pre>
<p> <em>NetworkKey is the secret 16 byte value used for secure communication with security devices.</em></p>
</li>
<li><p><code>npm run config deploy</code> to complete <code>zwave</code> service installation.</p>
</li>
</ol>
<h2 id="operation">Operation</h2>
<p>The <code>zwave</code> service settings will appear in the Settings/Services UI.</p>
<p>Use <code>Add device</code> and <code>Remove device</code> to perform include and exclude controller operations.</p>
<p>Once a device is added, it appears in the Device menu under its detected type. Additional ZWave device details and settings are available with a hold press.</p>
<h2 id="api">API</h2>
<p><code>zwave</code> implements <a href="https://github.com/theatersoft/device">device</a> types and interfaces common to all Theatersoft 
device services. All low level Z-Wave details (Command Class implementation, configuration, etc.) are hidden and managed internally. </p>
<h3 id="state">State</h3>
<p>Device state is published on the service bus object as a Device. E.g.:</p>
<pre><code>    &quot;ZWave.26&quot; : {
        name: &quot;Office&quot;,
        value: false,
        type: &quot;Switch&quot;,
        id: &quot;ZWave.26&quot;,
        time: 1516389670608
    }
</code></pre><h3 id="control">Control</h3>
<p>Actions control devices through the service<code>dispatch (action :Action)</code> API. A typical action for a <code>Switch</code> would be <code>on</code>, exported from <code>device</code> as <code>on = id =&gt; ({type: ON, id})</code>.</p>
<h3 id="repl-demo">REPL demo</h3>
<p>Start node using an installed NPM script to set the BUS environment: </p>
<pre><code class="language-bash">cd /opt/theatersoft &amp;&amp; npm explore @theatersoft/zwave npm run BUS -- node
</code></pre>
<p>Start the bus and create a <code>zwave</code> service proxy:</p>
<pre><code class="language-js">const {bus, proxy} = require(&#39;@theatersoft/bus&#39;)
bus.start()
const zwave = proxy(&#39;ZWave&#39;)
</code></pre>
<p>Then get the service state and check the devices:</p>
<pre><code class="language-js">zwave.getState().then(state =&gt; devices = state.devices)
devices // show the returned devices
</code></pre>
<p>Let’s find the devices that are on:</p>
<pre><code class="language-js">Object.values(devices).find(({value}) =&gt; value)
</code></pre>
<p>Suppose that returned <code>{ name: &#39;Kitchen outlet&#39;, value: true, type: &#39;Switch&#39;, id: &#39;5&#39; }</code>. Then we could turn it off:</p>
<pre><code class="language-js">zwave.dispatch({type: &#39;OFF&#39;, id: &#39;5&#39; })
</code></pre>
<h1 id="-theatersoft-x10">@theatersoft/x10</h1>
<p><code>x10</code> is a <a href="https://www.theatersoft.com">Theatersoft</a> <a href="https://github.com/theatersoft/bus">bus</a> service module that
encapsulates the <a href="https://en.wikipedia.org/wiki/X10_(industry_standard">X10</a>) home automation protocol to provide 
consistent <a href="https://github.com/theatersoft/device">device</a> APIs for X10 control and state management.</p>
<p>The <a href="https://www.x10.com/cm15a-module.html">CM15A USB Transceiver</a> is currently supported by 
encoding and decoding the interface streams from the USB controller using open sourced information about 
the X10 controller protocol.</p>
<p>X10 obviously has been legacy technology for a long time however I personally have X10 outdoor motion sensor floodlights that 
are still working reliably. This <code>x10</code> module allows them to be used within the Theatersoft platform.</p>
<h2 id="installation">Installation</h2>
<ol>
<li><p>Install <a href="https://www.theatersoft.com">Theatersoft</a>. </p>
</li>
<li><p>Add an X10 service configuration object to your site <code>config.json</code> to the <code>services</code> array of a <code>hosts</code> object. E.g:</p>
<pre><code class="language-json">   {
     &quot;enabled&quot;: true,
     &quot;module&quot;: &quot;@theatersoft/x10&quot;,
     &quot;export&quot;: &quot;X10&quot;,
     &quot;name&quot;: &quot;X10&quot;,
     &quot;config&quot;: {
       &quot;vid&quot;: 3015,
       &quot;pid&quot;: 1,
       &quot;devices&quot;: [
         {
           &quot;name&quot;: &quot;Garage&quot;,
           &quot;model&quot;: &quot;VT38A&quot;,
           &quot;id&quot;: &quot;A3&quot;,
           &quot;type&quot;: &quot;Switch&quot;
         },
         {
           &quot;name&quot;: &quot;Deck&quot;,
           &quot;model&quot;: &quot;PR511&quot;,
           &quot;id&quot;: &quot;A8&quot;,
           &quot;type&quot;: &quot;Switch&quot;
         },
         {
           &quot;name&quot;: &quot;Deck Motion&quot;,
           &quot;id&quot;: &quot;A9&quot;,
           &quot;type&quot;: &quot;MotionSensor&quot;
         }
       ]
     }
   }
</code></pre>
<p> X10 cannot discover devices on its own so you’ll need to preconfigure your own devices.</p>
</li>
<li><p><code>npm run config deploy</code> if you installed Theatersoft using <code>@theatersoft/home</code>; otherwise install <code>@theatersoft/x10</code>
and restart the server manually.  </p>
</li>
</ol>
<h2 id="api">API</h2>
<p>Actions control devices through the <code>X10.dispatch (action :Action)</code> API. Within the <code>X10</code> module, an action would appear 
as <code>{type: &quot;ON&quot;, id: &quot;A3&quot;}</code>. (Applications normally invoke actions indirectly through the <code>device</code> module, so the <code>id</code>
would actually be <code>X10.A3</code>.)</p>
<p>State is accessed by listening to state signals on the <code>x10</code> bus service object. A device state has the form:</p>
<pre><code>    &quot;X10.A3&quot; : {
        name: &quot;Garage&quot;,
        value: false,
        type: &quot;Switch&quot;,
        id: &quot;X10.A3&quot;,
        time: 1516156060728
    }
</code></pre><h1 id="serial">serial</h1>
<p>Bus service module for serial devices</p>
</div></article></main>
<footer><div><span>© 2018 Theatersoft, LLC</span></div></footer>
</body>
</html>